app:
  description: AIæ™ºèƒ½æ–‡æ¡£æ’ç‰ˆ â€” æ”¯æŒæ–‡ä»¶ä¸Šä¼  + æ–‡æ¡£æå–å™¨ï¼Œæ ¹æ®ç”¨æˆ·æ’ç‰ˆæŒ‡ä»¤å¯¹æ–‡æ¡£è¿›è¡Œç»“æ„è¯†åˆ«ï¼Œè¾“å‡ºå¸¦å­—ä½“å­—å·é¢œè‰²ç­‰å¯Œæ ¼å¼å±æ€§çš„ç»“æ„åŒ– JSONï¼ˆChatflow + Structured Outputï¼‰
  icon: ğŸ“
  icon_background: "#E0E7FF"
  mode: advanced-chat
  name: æ™ºèƒ½æ–‡æ¡£æ’ç‰ˆ
  use_icon_as_answer_icon: false
dependencies:
  - current_identifier: null
    type: marketplace
    value:
      marketplace_plugin_unique_identifier: langgenius/tongyi:0.1.28@ad074894f4aac6840ef8fb68dbfcf51d13c7800450757a8d99bacbefd245a6ab
    version: null
kind: app
version: 0.6.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
        - .TXT
        - .MD
        - .MARKDOWN
        - .PDF
        - .DOCX
        - .DOC
        - .XLSX
        - .XLS
        - .CSV
        - .HTML
        - .JSON
        - .XML
      allowed_file_types:
        - document
      allowed_file_upload_methods:
        - remote_url
        - local_file
      enabled: true
      fileUploadConfig:
        file_size_limit: 50
        file_upload_limit: 10
      number_limits: 3
    opening_statement: æ‚¨å¥½ï¼æˆ‘æ˜¯æ™ºèƒ½æ–‡æ¡£æ’ç‰ˆåŠ©æ‰‹ã€‚è¯·ä¸Šä¼ æ–‡æ¡£å¹¶æè¿°æ‚¨çš„æ’ç‰ˆéœ€æ±‚ï¼Œå¯ä»¥è¯´å¾—ç²—ä¸€äº›ï¼ˆå¦‚"è¿™æ˜¯ä¸€ä»½é€šçŸ¥ï¼Œè¯·æŒ‰å…¬æ–‡æ ‡å‡†æ’ç‰ˆ"ï¼‰æˆ–ç»†ä¸€äº›ï¼ˆå¦‚"æ ‡é¢˜äºŒå·æ–¹æ­£å°æ ‡å®‹çº¢è‰²å±…ä¸­"ï¼‰ï¼Œä¹Ÿå¯ä»¥ç²—ç»†ç»“åˆã€‚
    retriever_resource:
      enabled: false
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
      - è¿™æ˜¯ä¸€ä»½é€šçŸ¥ï¼Œè¯·æŒ‰å…¬æ–‡æ ‡å‡†æ’ç‰ˆ
      - æŒ‰å­¦æœ¯è®ºæ–‡æ ¼å¼é‡æ–°æ’ç‰ˆ
      - è¯·è¯†åˆ«æ–‡æ¡£ç»“æ„å¹¶æ ‡å‡†åŒ–æ’ç‰ˆ
    suggested_questions_after_answer:
      enabled: true
    text_to_speech:
      enabled: false
      language: ""
      voice: ""
  graph:
    edges:
      - data:
          sourceType: start
          targetType: document-extractor
        id: start-document-extractor
        source: start
        sourceHandle: source
        target: document-extractor
        targetHandle: target
        type: custom
      - data:
          sourceType: document-extractor
          targetType: llm
        id: document-extractor-llm
        source: document-extractor
        sourceHandle: source
        target: llm
        targetHandle: target
        type: custom
      - data:
          sourceType: llm
          targetType: answer
        id: llm-answer
        source: llm
        sourceHandle: source
        target: answer
        targetHandle: target
        type: custom
    nodes:
      - data:
          selected: false
          title: ç”¨æˆ·è¾“å…¥
          type: start
          variables: []
        height: 73
        id: start
        position:
          x: 78
          y: 282
        positionAbsolute:
          x: 78
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 242

      - data:
          is_array_file: true
          selected: false
          title: æ–‡æ¡£æå–å™¨
          type: document-extractor
          variable_selector:
            - sys
            - files
        height: 88
        id: document-extractor
        position:
          x: 378
          y: 282
        positionAbsolute:
          x: 378
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 242

      - data:
          context:
            enabled: true
            variable_selector:
              - document-extractor
              - text
          memory:
            query_prompt_template: "{{#sys.query#}}"
            role_prefix:
              assistant: ""
              user: ""
            window:
              enabled: true
              size: 2
          model:
            completion_params:
              temperature: 0.2
              response_format: json_object
            mode: chat
            name: qwen-plus
            provider: langgenius/tongyi/tongyi
          prompt_template:
            - id: a1b2c3d4-e5f6-7890-abcd-ef1234567890
              role: system
              text: |-
                # è§’è‰²
                ä½ æ˜¯å…¬æ–‡æ’ç‰ˆä¸“å®¶ã€‚æ ¹æ®ç”¨æˆ·çš„æ’ç‰ˆæŒ‡ä»¤ï¼Œå¯¹æ–‡æ¡£æ–‡æœ¬è¿›è¡Œç»“æ„åˆ†æï¼Œä¸ºæ¯ä¸ªæ®µè½è¾“å‡ºåŒ…å«å†…å®¹ã€æ ·å¼ç±»å‹åŠå®Œæ•´æ ¼å¼å±æ€§çš„ç»“æ„åŒ– JSONã€‚

                # è¾“å…¥è¯´æ˜
                ç”¨æˆ·è¾“å…¥åŒ…å«ä¸¤éƒ¨åˆ†ï¼ˆå¯èƒ½åªæœ‰å…¶ä¸­ä¸€éƒ¨åˆ†ï¼‰ï¼š
                1. **æ’ç‰ˆæŒ‡ä»¤**ï¼šæè¿°æ’ç‰ˆéœ€æ±‚ï¼ˆå¯èƒ½æ˜¯é¢„è®¾æ ¼å¼çš„å®Œæ•´è¯´æ˜ï¼Œä¹Ÿå¯èƒ½æ˜¯ç®€çŸ­çš„è¦æ±‚ï¼Œä¹Ÿå¯èƒ½ä¸¤è€…ç»“åˆï¼‰
                2. **æ–‡æ¡£åŸæ–‡**ï¼šç”±æ–‡æ¡£æå–å™¨è‡ªåŠ¨æå–çš„æ–‡æœ¬å†…å®¹ï¼ˆé€šè¿‡ context æ³¨å…¥ï¼‰

                å¦‚æœç”¨æˆ·æ²¡æœ‰ç»™å‡ºå…·ä½“æ’ç‰ˆæŒ‡ä»¤ï¼Œè¯·æŒ‰å…¬æ–‡æ ‡å‡†ï¼ˆGB/T 9704ï¼‰è¿›è¡Œé»˜è®¤æ’ç‰ˆã€‚

                # ç»“æ„è¯†åˆ«è§„åˆ™

                æ ¹æ®æ–‡æœ¬å†…å®¹è‡ªåŠ¨è¯†åˆ«æ¯æ®µçš„ style_typeï¼š
                - titleï¼šæ–‡æ¡£æ ‡é¢˜è¡Œï¼ˆå¦‚"å…³äºXXXçš„é€šçŸ¥/æŠ¥å‘Š/è¯·ç¤º"ï¼‰
                - recipientï¼šä¸»é€æœºå…³è¡Œï¼ˆé¡¶æ ¼ï¼Œä»¥"ï¼š"ç»“å°¾ï¼‰
                - heading1ï¼šä»¥"ä¸€ã€""äºŒã€"ç­‰æ±‰å­—ç¼–å·å¼€å¤´
                - heading2ï¼šä»¥"ï¼ˆä¸€ï¼‰""ï¼ˆäºŒï¼‰"ç­‰ç¼–å·å¼€å¤´
                - heading3ï¼šä»¥"1.""2."ç­‰æ•°å­—ç¼–å·å¼€å¤´
                - heading4ï¼šä»¥"(1)""(2)"ç­‰å°æ‹¬å·ç¼–å·å¼€å¤´
                - bodyï¼šæ™®é€šæ­£æ–‡æ®µè½
                - closingï¼šç»“æŸè¯­ï¼ˆ"ç‰¹æ­¤é€šçŸ¥ã€‚""ä»¥ä¸ŠæŠ¥å‘Šï¼Œè¯·å®¡è®®ã€‚"ç­‰ï¼‰
                - signatureï¼šæ–‡æœ«å‘æ–‡æœºå…³ç½²å
                - dateï¼šæ–‡æœ«æ—¥æœŸè¡Œ
                - attachmentï¼šä»¥"é™„ä»¶"æˆ–"é™„ï¼š"å¼€å¤´çš„è¡Œ

                # âš ï¸ ä¸¥æ ¼è¾“å‡ºçº¦æŸï¼ˆè¿åå³ä¸ºé”™è¯¯ï¼‰

                ## style_type åªå…è®¸ä»¥ä¸‹å€¼ï¼š
                title, recipient, heading1, heading2, heading3, heading4, body, closing, signature, date, attachment
                ç¦æ­¢è¾“å‡ºå…¶å®ƒå€¼ï¼ˆå¦‚ h1ã€æ ‡é¢˜ã€æ­£æ–‡ã€heading_1 ç­‰ï¼‰ã€‚

                ## font_size åªå…è®¸ä»¥ä¸‹ä¸­æ–‡å­—å·åï¼š
                åˆå·ã€å°åˆã€ä¸€å·ã€å°ä¸€ã€äºŒå·ã€å°äºŒã€ä¸‰å·ã€å°ä¸‰ã€å››å·ã€å°å››ã€äº”å·ã€å°äº”
                âŒ ç¦æ­¢ï¼š1å·ã€2å·ã€16ptã€22pxã€å¤§å·ã€å°å·ã€ä¸€å·å­—ã€ä¸‰å·å­—ä½“

                ## font_family åªå…è®¸ä»¥ä¸‹å®Œæ•´å­—ä½“åï¼š
                æ–¹æ­£å°æ ‡å®‹ç®€ä½“ã€é»‘ä½“ã€æ¥·ä½“_GB2312ã€ä»¿å®‹_GB2312ã€å®‹ä½“ã€å¾®è½¯é›…é»‘
                âŒ ç¦æ­¢ï¼šä»¿å®‹ã€æ¥·ä½“ã€å°æ ‡å®‹ã€FangSongã€SimHeiã€KaiTiã€æ–¹æ­£å°æ ‡å®‹

                ## color åªå…è®¸ä»¥ä¸‹ 6 ä½åå…­è¿›åˆ¶å€¼ï¼š
                #000000ã€#CC0000ã€#333333ã€#666666ã€#0033CCã€#006600ã€#800080
                âŒ ç¦æ­¢ï¼šredã€é»‘è‰²ã€rgb(0,0,0)ã€#000ã€#ff0000

                ## alignment åªå…è®¸ä»¥ä¸‹å€¼ï¼š
                leftã€centerã€rightã€justify
                âŒ ç¦æ­¢ï¼šå±…ä¸­ã€å±…å·¦ã€ä¸¤ç«¯å¯¹é½

                ## bold å’Œ italic å¿…é¡»æ˜¯å¸ƒå°”å€¼ true æˆ– falseï¼Œä¸èƒ½æ˜¯å­—ç¬¦ä¸²ã€‚

                ## indent ä½¿ç”¨å­—ç¬¦ä¸²æ ¼å¼ï¼Œå¦‚ "2em" æˆ– "0"ã€‚

                ## line_height ä½¿ç”¨å­—ç¬¦ä¸²æ ¼å¼çš„å€æ•°ï¼Œå¦‚ "2" æˆ– "1.5"ã€‚

                ## red_line å¸ƒå°”å€¼ï¼Œä»…å¯¹ title ç±»å‹æœ‰æ•ˆï¼š
                - trueï¼šæ ‡é¢˜ä¸‹æ–¹æ˜¾ç¤ºçº¢è‰²åˆ†éš”çº¿ï¼ˆåˆç§°çº¢çº¿ã€çº¢è‰²æ¨ªçº¿ã€æ¨ªçº¿ï¼‰
                - falseï¼šä¸æ˜¾ç¤ºçº¢è‰²åˆ†éš”çº¿
                - title æ®µè½é»˜è®¤ä¸º trueï¼Œé title æ®µè½å¿…é¡»ä¸º false
                - red_line æ˜¯**å¿…å¡«å­—æ®µ**ï¼Œæ¯ä¸ªæ®µè½éƒ½å¿…é¡»æ˜¾å¼è¾“å‡º
                - å½“ç”¨æˆ·è¯´ã€Œåˆ æ‰çº¢çº¿ã€ã€Œå»æ‰çº¢çº¿ã€ã€Œåˆ æ‰çº¢è‰²æ¨ªçº¿ã€ã€Œå»æ‰æ¨ªçº¿ã€ã€Œç§»é™¤åˆ†éš”çº¿ã€ç­‰ç±»ä¼¼è¡¨è¿°æ—¶ï¼Œå°†å¯¹åº” title æ®µè½è®¾ä¸º false

                # å¢é‡ä¿®æ”¹æ¨¡å¼ï¼ˆç´¢å¼•æ¨¡å¼ â€” ä»…è¾“å‡ºè¢«ä¿®æ”¹çš„æ®µè½ï¼‰
                å½“ç”¨æˆ·è¾“å…¥åŒ…å«å¸¦ç´¢å¼•çš„æ®µè½åˆ—è¡¨ï¼ˆå¦‚ `[0] (title, äºŒå·, ...) æ–‡æ¡£æ ‡é¢˜`ï¼‰æ—¶ï¼Œè¡¨ç¤ºè¿™æ˜¯å¢é‡ä¿®æ”¹è¯·æ±‚ï¼š
                - è¾“å…¥æ¯è¡Œæ ¼å¼ï¼š`[ç´¢å¼•] (å±æ€§åˆ—è¡¨) æ®µè½æ–‡æœ¬`
                - **ä»…è¾“å‡ºéœ€è¦ä¿®æ”¹çš„æ®µè½**ï¼Œæœªä¿®æ”¹çš„æ®µè½ä¸è¦è¾“å‡º
                - æ¯ä¸ªè¾“å‡ºæ®µè½å¿…é¡»åŒ…å« `_index` å­—æ®µï¼ˆæ•´æ•°ï¼Œå¯¹åº”è¾“å…¥ä¸­çš„ [N] åºå·ï¼‰
                - æ¯ä¸ªè¾“å‡ºæ®µè½ä»é¡»åŒ…å«å®Œæ•´çš„ 11 ä¸ªå±æ€§å­—æ®µ + `_index`
                - å¦‚æœæ— éœ€ä»»ä½•ä¿®æ”¹ï¼Œè¾“å‡º `{"paragraphs": []}`
                - ä¸å¾—æ“…è‡ªä¿®æ”¹ç”¨æˆ·æœªè¦æ±‚ä¿®æ”¹çš„å±æ€§

                # æ ¸å¿ƒè§„åˆ™
                1. **ä¿æŒåŸæ–‡**ï¼šä¸ä¿®æ”¹ã€ä¸åˆ å‡ã€ä¸å¢åŠ åŸæ–‡æ–‡å­—å†…å®¹ï¼Œåªåšç»“æ„è¯†åˆ«å’Œæ ¼å¼æ ‡æ³¨
                2. **æ®µè½æ‹†åˆ†**ï¼šå¦‚æœä¸€è¡Œæ··åˆäº†æ ‡é¢˜å’Œæ­£æ–‡ï¼Œå¿…é¡»æ‹†åˆ†ä¸ºä¸¤ä¸ªæ®µè½
                3. **æ¯æ®µå¿…é¡»åŒ…å«å…¨éƒ¨ 11 ä¸ªå­—æ®µ**ï¼štext, style_type, font_size, font_family, bold, italic, color, indent, alignment, line_height, red_lineï¼ˆå¢é‡æ¨¡å¼è¿˜éœ€åŠ  _indexï¼‰
                4. **ä¸¥æ ¼ JSON**ï¼šè¾“å‡ºå¿…é¡»æ˜¯åˆæ³• JSONï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦å¿…é¡»æ˜¯ `{`ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦å¿…é¡»æ˜¯ `}`ï¼Œä¸è¦è¾“å‡º markdown ä»£ç å—æ ‡è®°

                # è¾“å‡ºæ ¼å¼

                ## å…¨é‡æ¨¡å¼ï¼ˆé¦–æ¬¡æ’ç‰ˆï¼‰
                {
                  "paragraphs": [
                    {
                      "text": "æ®µè½åŸæ–‡å†…å®¹",
                      "style_type": "title",
                      "font_size": "äºŒå·",
                      "font_family": "æ–¹æ­£å°æ ‡å®‹ç®€ä½“",
                      "bold": false,
                      "italic": false,
                      "color": "#000000",
                      "indent": "0",
                      "alignment": "center",
                      "line_height": "2",
                      "red_line": true
                    }
                  ]
                }

                ## å¢é‡æ¨¡å¼ï¼ˆä»…è¾“å‡ºè¢«ä¿®æ”¹çš„æ®µè½ï¼Œé™„ _indexï¼‰
                {
                  "paragraphs": [
                    {
                      "_index": 3,
                      "text": "ä¿®æ”¹åçš„æ®µè½æ–‡æœ¬",
                      "style_type": "body",
                      "font_size": "å°å››",
                      "font_family": "ä»¿å®‹_GB2312",
                      "bold": false,
                      "italic": false,
                      "color": "#000000",
                      "indent": "2em",
                      "alignment": "left",
                      "line_height": "1.5",
                      "red_line": false
                    }
                  ]
                }

                {{#context#}}
            - id: b2c3d4e5-f6a7-8901-bcde-f12345678901
              role: user
              text: "{{#sys.query#}}"
          selected: false
          title: AIæ’ç‰ˆå¼•æ“
          type: llm
          vision:
            enabled: false
        height: 88
        id: llm
        position:
          x: 678
          y: 282
        positionAbsolute:
          x: 678
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 242

      - data:
          answer: "{{#llm.text#}}"
          selected: false
          title: ç›´æ¥å›å¤
          type: answer
          variables: []
        height: 103
        id: answer
        position:
          x: 978
          y: 282
        positionAbsolute:
          x: 978
          y: 282
        selected: false
        sourcePosition: right
        targetPosition: left
        type: custom
        width: 242
    viewport:
      x: 100
      y: 50
      zoom: 0.85
  rag_pipeline_variables: []
